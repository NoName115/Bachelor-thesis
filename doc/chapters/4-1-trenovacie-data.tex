
\section{Trénovacie dáta}
\label{sec:trenovaciedata}

\subsection{Zber dát}
Pre trénovanie modelov boli použité obrázky zo zdrojov spomenutých v kapitole \ref{sec:databaza}.
Tabuľka nižšie uvádza podrobné počty obrázkov z daných zdrojov ktoré boli použité pre určenie typu zbrane v 2 kategóriách.

\begin{table}[H]
  \centering
  \label{my-label}
  \begin{tabular}{|l|c|c|}
    \hline
    Zdroj               & \multicolumn{1}{l|}{Počet krátkych zbraní} & \multicolumn{1}{l|}{Počet dlhých zbraní} \\ \hline
    IMFDB               & 647                                        & 670                                      \\ \hline
    ImageNet            & 730                                        & 94                                       \\ \hline
    Google vyhľadávanie & 0                                          & 86                                       \\ \hline \hline
    SPOLU               & 1377                                       & 850                                      \\ \hline
  \end{tabular}
  \caption{Podrobné počty trénovacích dát.}
\end{table}

Vo všeobecnosti je jednoduchšie nájsť obrázky ktoré obsahujú krátke zbrane (pištole) ako dlhé zbrane.
Databáza ImageNet obsahovala vyše 3000 odkazov na obrázky, avšak veľká časť z nich bola chybná alebo daný súbor už neexistoval.

Ako bolo spomínane v \ref{subsec:generovanie3d}, obrázky ktoré boli použité na trénovanie modelov pre určenie náklonu zbrane bolo potrebné
    vygenerovať pomocou 3D modelov.
Pre toto generovanie bolo použitých 10 pozadí scény a 5 3D modelov z toho 3 modely boli dlhé zbrane a 2 modely krátkych zbraní.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{generator3d}
    \caption{Program pre generovanie obrázkov z 3D modelov.}
    \label{pic:generator3d}
\end{figure}

Niektoré použité modely mali nastavený zlý bod otáčania a taktiež boli veľmi malé.
Preto, ako je vidieť na obrázku \ref{pic:generator3d}, museli byť výsledne obrázky ešte orezané aby sa vnich nachádzala iba zbran bez nepotrebného okolia.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{croped_weapon}
    \caption{Výsledný vygenerovaný obrázok po orezaní okolia.}
    \label{pic:generator3d}
\end{figure}

Tabuľka nižsie uvádza presné počty vygenerovaných obrázkov.

\begin{table}[H]
    \centering
    \label{my-label}
    \begin{tabular}{|l|c|}
        \hline
        Typ osi otáčania & \multicolumn{1}{l|}{Počet obrázkov} \\ \hline
        pitch            & 1480                                \\ \hline
        roll             & 4450                                \\ \hline
        yaw              & 4600                                \\ \hline
        \end{tabular}
    \caption{Podrobné počty trénovacích dát.}
\end{table}

Pre os otáčania pitch boli vybrané obrázky z datasetu určeného pre klasifikáciu typu zbrane.
Pre zvyšné 2 osi boli obrázky generované, počty sa líša kvôli niektorým chybným obrázkom ktoré museli byť vymazané.

\subsection{Načitavanie dát}
\label{subsec:nacitaniedat}
Pre načitavanie dát je implementovaná trieda DataLoader v scripte loader.py.
Trieda obsahuje niekoľko funkcií pre načitanie týchto dát, tieto funkcie vrátia pole načitaných obrázkov, pole indexov označení [eng. labels] obrázkov a
    štruktúru typu dictionary ktorá obsahuje index a názov označenia, npr. \{0: ``kratka zbran'', 1: ``dlha zbran''\}.

Prvá z funkcií načitáva dáta z priečinka kde označenie obrázkou, či je to krátka alebo dlhá zbraň, je zabezpečené podľa názvou podpriečinkou.
Pre obrázky o náklne zbrane sa označenie osi berie takisto z názvu podpriečinka, avšak presné označenie o koľko stupňov je model v obrázku otočený
    je získaný z názvu obrázka ktorý musí spĺnať presný formát: \textit{p0.0\_y0.0\_r0.0-typzbrane.jpg}.
Kde \textit{p0.0} označuje hodnotu náklnu v osi pitch, \textit{y0.0} hodnotu náklnu v osi yaw, \textit{r0.0} v osi roll a \textit{typzbrane} môže byť
    akýkoľvek reťazec.

Správnu hierarchiu priečinkou je vidieť na obrázoku \ref{pic:folderhierarchy}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.32\textwidth]{class_hierarchy}
    \qquad
    \includegraphics[width=0.4\textwidth]{angle_hierarchy}
    \caption{Hierarchia priečinkou pre správne označenie vstupných obrázkou.}
    \label{pic:folderhierarchy}
\end{figure}

Druhá z funkcií umožnuje načítať zoznam obrázkou z textového súboru, kde sa na každom riadku nachádza práve jedna cesta k požadovanému obrázku.
Spôspob označovania obrázkov je rovnaký ako v prvom prípade, preto je taktiež potrebné dodržat správnu hierachiu priečinkou.

\subsection{Predspracovanie dát}
\label{subsec:predspracovaniedat}
- preprocessing.py - Preprocessor, Preprocessing
- ktore triedy implementujú augmentáciu
- opisat celkovu triedu od Keras-u + Moja vlastne 2 triedy ktore som implementoval
- ako prebiehala augmentacia dat, opisat funkcie ktore sa pouzivaju pre dogenerovanie obrazkov a nazov tried ktore to implementuju.
